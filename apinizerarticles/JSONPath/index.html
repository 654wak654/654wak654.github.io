<!DOCTYPE html>
<html>
<head>
<title>JSONPath</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1">
<meta http-equiv=Content-type content="text/html;charset=UTF-8">
<link href=../../styles.css rel=stylesheet>
<style>body{font-family:"Segoe WPC","Segoe UI","SFUIText-Light","HelveticaNeue-Light",sans-serif,"Droid Sans Fallback";font-size:14px;padding:0 12px;line-height:22px;word-wrap:break-word}#code-csp-warning{position:fixed;top:0;right:0;color:white;margin:16px;text-align:center;font-size:12px;font-family:sans-serif;background-color:#444;cursor:pointer;padding:6px;box-shadow:1px 1px 1px rgba(0,0,0,.25)}#code-csp-warning:hover{text-decoration:none;background-color:#007acc;box-shadow:2px 2px 2px rgba(0,0,0,.25)}body.scrollBeyondLastLine{margin-bottom:calc(100vh - 22px)}body.showEditorSelection .code-line{position:relative}body.showEditorSelection .code-active-line:before,body.showEditorSelection .code-line:hover:before{content:"";display:block;position:absolute;top:0;left:-12px;height:100%}body.showEditorSelection li.code-active-line:before,body.showEditorSelection li.code-line:hover:before{left:-30px}.vscode-light.showEditorSelection .code-active-line:before{border-left:3px solid rgba(0,0,0,0.15)}.vscode-light.showEditorSelection .code-line:hover:before{border-left:3px solid rgba(0,0,0,0.40)}.vscode-dark.showEditorSelection .code-active-line:before{border-left:3px solid rgba(255,255,255,0.4)}.vscode-dark.showEditorSelection .code-line:hover:before{border-left:3px solid rgba(255,255,255,0.60)}.vscode-high-contrast.showEditorSelection .code-active-line:before{border-left:3px solid rgba(255,160,0,0.7)}.vscode-high-contrast.showEditorSelection .code-line:hover:before{border-left:3px solid rgba(255,160,0,1)}img{max-width:100%;max-height:100%}a{color:#4080d0;text-decoration:none}a:focus,input:focus,select:focus,textarea:focus{outline:1px solid -webkit-focus-ring-color;outline-offset:-1px}hr{border:0;height:2px;border-bottom:2px solid}h1{padding-bottom:.3em;line-height:1.2;border-bottom-width:1px;border-bottom-style:solid}h1,h2,h3{font-weight:normal}h1 code,h2 code,h3 code,h4 code,h5 code,h6 code{font-size:inherit;line-height:auto}a:hover{color:#4080d0;text-decoration:underline}table{border-collapse:collapse}table>thead>tr>th{text-align:left;border-bottom:1px solid}table>thead>tr>th,table>thead>tr>td,table>tbody>tr>th,table>tbody>tr>td{padding:5px 10px}table>tbody>tr+tr>td{border-top:1px solid}blockquote{margin:0 7px 0 5px;padding:0 16px 0 10px;border-left:5px solid}code{font-family:Menlo,Monaco,Consolas,"Droid Sans Mono","Courier New",monospace,"Droid Sans Fallback";font-size:14px;line-height:19px}body.wordWrap pre{white-space:pre-wrap}.mac code{font-size:12px;line-height:18px}pre:not(.hljs),pre.hljs code>div{padding:16px;border-radius:3px;overflow:auto}.vscode-light,.vscode-light pre code{color:#1e1e1e}.vscode-dark,.vscode-dark pre code{color:#DDD}.vscode-high-contrast,.vscode-high-contrast pre code{color:white}.vscode-light code{color:#a31515}.vscode-dark code{color:#d7ba7d}.vscode-light pre:not(.hljs),.vscode-light code>div{background-color:rgba(220,220,220,0.4)}.vscode-dark pre:not(.hljs),.vscode-dark code>div{background-color:rgba(10,10,10,0.4)}.vscode-high-contrast pre:not(.hljs),.vscode-high-contrast code>div{background-color:#000}.vscode-high-contrast h1{border-color:#000}.vscode-light table>thead>tr>th{border-color:rgba(0,0,0,0.69)}.vscode-dark table>thead>tr>th{border-color:rgba(255,255,255,0.69)}.vscode-light h1,.vscode-light hr,.vscode-light table>tbody>tr+tr>td{border-color:rgba(0,0,0,0.18)}.vscode-dark h1,.vscode-dark hr,.vscode-dark table>tbody>tr+tr>td{border-color:rgba(255,255,255,0.18)}.vscode-light blockquote,.vscode-dark blockquote{background:rgba(127,127,127,0.1);border-color:rgba(0,122,204,0.5)}.vscode-high-contrast blockquote{background:transparent;border-color:#fff}</style>
<style>.hljs-comment,.hljs-quote{color:#8e908c}.hljs-variable,.hljs-template-variable,.hljs-tag,.hljs-name,.hljs-selector-id,.hljs-selector-class,.hljs-regexp,.hljs-deletion{color:#c82829}.hljs-number,.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-type,.hljs-params,.hljs-meta,.hljs-link{color:#f5871f}.hljs-attribute{color:#eab700}.hljs-string,.hljs-symbol,.hljs-bullet,.hljs-addition{color:#718c00}.hljs-title,.hljs-section{color:#4271ae}.hljs-keyword,.hljs-selector-tag{color:#8959a8}.hljs{display:block;overflow-x:auto;color:#4d4d4c;padding:.5em}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:bold}</style>
<style>body{font-family:"Meiryo","Segoe WPC","Segoe UI","SFUIText-Light","HelveticaNeue-Light",sans-serif,"Droid Sans Fallback"}pre{background-color:#f8f8f8;border:1px solid #ccc;border-radius:3px;overflow-x:auto;white-space:pre-wrap;overflow-wrap:break-word}pre:not(.hljs){padding:23px;line-height:19px}blockquote{background:rgba(127,127,127,0.1);border-color:rgba(0,122,204,0.5)}.emoji{height:1.4em}:not(pre):not(.hljs)>code{color:#c9ae75;font-size:inherit}.page{page-break-after:always}section{text-align:inherit}body{font-size:16px}</style>
</head>
<body>
<div class=wrapper>
<section>
<h1 id=jsonpath-ile-veri-filtereleme>JSONPath ile Veri Filtereleme</h1>
<h2 id=nedir-jsonpath>Nedir JSONPath</h2>
<p>JSONPath, köklerini XPath'den alan, XPath'in XML için yaptığını JSON formatı ile yapabilmemizi sağlıyan bir araçtır. Peki XPath XML için ne yapıyorki aynısını JSON için yapabilmek istiyoruz? XPath (ve dolayısıyla JSONPath), elimizdeki bir veriden belli parçaları seçmek için bize kulanımı kolay bir yapı sağlayan küçük bir kütüphanedir. Amaçları ve sonuçları çok farklı olsada kullanımını RegEx'e benzetebiliriz. İkiside bir yapı ve bir dizi kural alıp bize aradığımz tipte bir yapı veriyor. Bizim sağladığımız bu kurallarıda <em>çok</em> basit bi scripting dili olarak düşünebiliriz; ancak python gibi tam teşekküllü bir scripting dilinden daha çok linux'un <code>grep</code> gibi &quot;utility&quot; programlarına daha çok benzerliği var. JSONPath bu görevi XML formatındaki değil, artık modern web'in çoğu alanında xml'in yerini almış json için yapabilmemizi sağlıyor.</p>
<p>Yaratıcısı Stefan Goessner'ın örneğini verdiği avantajlar amacını daha kısa bir şekilde anlatıyor:</p>
<ul>
<li>
<p>Client tarafında JSON için özel kod yazmaya gerek kalmadan JSON yapılarından veri dinamik bir şekilde bulunabilir ve alınabilir.</p>
</li>
<li>
<p>Sunucu tarafında client'dan istenen veri sadece gerekli parçalarına düşürülüp yollanabilir böylece sunucuda ağ kullanımı düşer.</p>
</li>
</ul>
<h2 id=jsonpath-expressionlar>JSONPath Expression'lar</h2>
<p>JSONPath ile expression'lar oluştururken kullanabileceğimiz 2 farklı notasyon var. Bunların biri c tipi dillere daha yakın nokta notasyonu <code>$.store.book[0].title</code>, diğeride olayı array'lere benzeten parantez notasyonu <code>$['store']['book'][0]['title']</code> (Tek tırnak işareti önemli, JSONPath'in bazı eski ve yaygın versiyonları çift tırnak ile çalışmıyor, buna dikkat edin!). Baştaki dolar operatörü ise json verisinin kök kısmını sembolize ediyor.</p>
<p>Bu iki notasyon arasındaki fark işin basit kısmı. Ayrıca şimdi göreceğiz ki ikisi birbiriyle karıştırılarak kullanılabiliyor. JSONPath'in bize sunduğu asıl avantajları veri üzerinde yapabildiğimiz mantıksal işlemler. Bu işlemleri şu şekilde sıralayabiliriz:</p>
<ul>
<li>Üye isimleri ve array indexleri için wildcard (<code>*</code>) kullanabilmek.</li>
<li>Bir üst objeye geri çıkabilmemizi sağlayan <em>descendant operator</em> (<code>..</code>) desteği.</li>
<li>Python'dan aşina olabilceğiniz <em>array slice</em> (<code>[start:end:step]</code>) ile arrayler üzerinde seçimler yapabilmek.</li>
<li>İçinde bulunduğumuz objenin değerlerine <code>@</code> operatörü ile erişebilmek.</li>
<li>Parantez içindeki özel expression'ları kullanarak mantıksal filtelemeler yapabilmek.</li>
</ul>
<p>Yukarıda son bahsettiğim 2 işlem JSONPath'in en güçlü yönleri, bu yüzden o ikisini biraz daha açmam gerektiğini düşünüyorum. Parantez içinde koyulan expression'lar ile objelerin sahip oldukları değerleri onlara karşı kullanabiliyoruz.</p>
<p><code>$.store.book[(@.length - 1)].title</code></p>
<p>Bu örnekte <code>book</code> array'inin son elementinin ismini almış oluyoruz. Parantezlere ve array'i temsil eden <code>@</code> operatörüne dikkat.</p>
<p>Yine parantezler ve <code>@</code> operatörü kullanırken, parantezin başına soru işareti ekleyerek belirlediğimiz koşullara uyan objeleri filtreleyebiliyoruzda.</p>
<p><code>$.store.book[?(@.price &lt; 10)].title</code></p>
<p>Bu örnekte ise fiyatları 10'un altında olan kitapların fiyatlarını almış olduk. Eğer bunu Java veya Python gibi bir dilin JSON kütüphanesiyle yapmak istesek ortaya çok daha uzun bir sonuç çıkıyor. Eğer kodu okuyan da JSONPath biliyorsa, bu expression'ı takip etmek tonlarca <code>for</code> ve <code>if</code> grubunu takip etmekten çok daha kolay oluyor.</p>
<h2 id=yararl%C4%B1-kaynaklar>Yararlı Kaynaklar</h2>
<p>JSONPath'in burada bahsettiğimden daha fazla operatörü, fonksiyonu, ve sayısız örneği var. JSONPath'in orijinal kaynağı olan <a href=http://goessner.net/articles/JsonPath>bu sayfayı</a> ziyaret ederseniz tüm operatörlerin bir tablosunu ve daha fazla örneği bulabilirsiniz. Onun üstüne <a href=https://github.com/json-path/JsonPath>GitHub'da</a> çok popüler bir java implementasyonu var.</p>
</section>
</div>
</body>
</html>
